<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/HKR/jsps/layui/css/layui.css">
    <script type="text/javascript" src="/HKR/jsps/layui/layui.js"></script>
    <script type="text/javascript" src="/HKR/jsps/js/jquery-1.7.2.min.js"></script>
    <link rel="stylesheet" href="/HKR/jsps/font-awesome-4.7.0/css/font-awesome.css">
</head>
<body>

<!--表单开始-->

<div id="processform" class="layui-form  layui-form-pane" style="margin: 30px 10px;" lay-filter="processform">

    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">开始时间</label>
            <div class="layui-input-inline">
                <input class="layui-input" readonly="readonly"  name="registerDate" id="registerDate" lay-verify="required" type="text" autocomplete="off"/>
            </div>
        </div>
    </div>


    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">结束时间</label>
            <div class="layui-input-inline">
                <input class="layui-input"  readonly="readonly" name="enddate" id="enddate" lay-verify="required" type="text" autocomplete="off"/>
            </div>
        </div>
    </div>

    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">请假天数</label>
            <div class="layui-input-inline">
                <input class="layui-input"   name="leavetotal" id="leavedays" lay-verify="required" type="number" autocomplete="off"/>
            </div>
        </div>
    </div>


    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">项目进度</label>
            <div class="layui-input-inline">
<!--                <input class="layui-input" name="status" id="status" lay-verify="required" type="text" autocomplete="off"/>-->
                <select readonly="readonly" name="secname" lay-filter="secname" lay-verify="required" id="secname">
                    <option value=""></option>
                    <option value="第一阶段">第一阶段（综合项目测试）</option>
                    <option value="第二阶段">第二阶段（金融专题项目测试）</option>
                    <option value="第三阶段">第三阶段（Python自动化测试）</option>
                    <option value="第四阶段">第四阶段（接口自动化测试）</option>
                    <option value="第五阶段">第五阶段（性能测试）</option>
                    <option value="第六阶段">全部完成</option>
                </select>

            </div>
        </div>
    </div>


    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">学籍状态</label>
            <div class="layui-input-block">
                <select name="graduation" lay-filter="graduation" lay-verify="required" id="graduation">
                    <option value=""></option>
                    <option value="在籍">在籍</option>
                    <option value="已就业">已就业</option>
                    <option value="中途退学">中途退学</option>
                </select>
            </div>
        </div>
    </div>

    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit lay-filter="formDemo">保存</button>
        </div>
    </div>
</div>
<script>


    //根据QueryString参数名称获取值
    //获取传入这个html的uid的参数
    function getQueryStringByName(name){

        var result = location.search.match(new RegExp("[\?\&]" + name+ "=([^\&]+)","i"));
        if(result == null || result.length < 1){
            return "";
        }
        return result[1];

    }
    function getNowFormatDate() {
        var date = new Date();
        var seperator1 = "-";
        var seperator2 = ":";
        var month = date.getMonth() + 1;
        var strDate = date.getDate();
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (strDate >= 0 && strDate <= 9) {
            strDate = "0" + strDate;
        }
        var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
        return currentdate;
    }
    var today = getNowFormatDate();

    $(document).ready(function () {


        /*给表单注册登录事件*/
        layui.use(["form","layer",'laydate'],function(){
            form = layui.form;
            layer = layui.layer;
            laydate = layui.laydate;


            laydate.render({
                elem:"#enddate",
                type:"date",
                /*min:today,*/
                trigger:'click'

            });
            laydate.render({
                elem:"#registerDate",
                type:"date",
                max:today,
                trigger:'click'

            });



            form.on("submit(formDemo)",function(data){

                var da = data.field;


                da["uid"]=getQueryStringByName("uid");

                console.log(JSON.stringify(da))
                $.ajax({
                    url:"/HKR/teacher/updateProcess",
                    type:"post",
                    contentType:"application/json",
                    async:false,
                    data:JSON.stringify(da),
                    success:function (res) {
                        console.log(res);
                        if(res.success){
                            layer.msg("提交成功!")
                            var index = parent.layer.getFrameIndex(window.name);
                            parent.layer.close(index);
                            parent.location.reload();
                        }else{
                            layer.alert(res.msg,{icon:5,title:"错误"});
                            return false;
                        }
                    },
                    error:function () {
                        layer.alert("提交失败！")
                    }
                });
                return false;
            });
        });
    })
</script>


</body>
</html>